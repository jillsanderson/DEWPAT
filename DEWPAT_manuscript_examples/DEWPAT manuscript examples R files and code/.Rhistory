setwd("/Users/jill/Documents/Grad School/Mahler Lab/Data/GitHub/DEWPAT/DEWPAT_manuscript_examples/DEWPAT manuscript examples R files and code")
########################################## Example 3
library(ggplot2)
# Bee only
flower_dat_bee <- read.csv("flowers_bee.csv", header = TRUE,na.strings = c("", "NA"))
names(flower_dat_bee)
flower_dat_bee$GPC_stnd <-
(flower_dat_bee$Global.Patch.Covariance - min(flower_dat_bee$Global.Patch.Covariance)) /
(max(flower_dat_bee$Global.Patch.Covariance) - min(flower_dat_bee$Global.Patch.Covariance))
#plot
theme <-  theme_bw() + theme(legend.direction="horizontal", legend.position=c(0.9,1.034), legend.title=element_blank(), text = element_text(size = 19))
flower <- ggplot(flower_dat_bee, aes(x=species, y=GPC_stnd)) +
geom_violin(trim=FALSE, fill="gray")+
labs(title="", x = "", y = "Global Heterogeneity")
flower + theme
lm <- lm(GPC_stnd ~ species, data=flower_dat_bee)
summary(lm) # p = 0.0316, adjusted R squared = 0.1566
anova_result <- aov(GPC_stnd ~ species, data = flower_dat_bee)
summary(anova_result) # F-statistic = 186.2, p < 0.001
# Vis only
flower_dat_vis <- read.csv("flowers_vis.csv", header = TRUE,na.strings = c("", "NA"))
flower_dat_vis$GPC_stnd <-
(flower_dat_vis$Global.Patch.Covariance - min(flower_dat_vis$Global.Patch.Covariance)) /
(max(flower_dat_vis$Global.Patch.Covariance) - min(flower_dat_vis$Global.Patch.Covariance))
#plot
theme <-  theme_bw() + theme(legend.direction="horizontal", legend.position=c(0.9,1.034), legend.title=element_blank(), text = element_text(size = 19))
flower <- ggplot(flower_dat_vis, aes(x=species, y=GPC_stnd)) +
geom_violin(trim=FALSE, fill="gray")+
labs(title="", x = "", y = "Global Heterogeneity")
flower + theme
lm <- lm(GPC_stnd ~ species, data=flower_dat_vis)
summary(lm) # p = 3.24e-12, adjusted R squared = 0.8895
anova_result <- aov(GPC_stnd ~ species, data = flower_dat_vis)
summary(anova_result) # F-statistic = 186.2, p < 0.001
flower <- ggplot(flower_dat_bee, aes(x=species, y=Global.Patch.Covariance)) +
geom_violin(trim=FALSE, fill="gray")+
labs(title="", x = "", y = "Global Heterogeneity")
flower + theme
#plot
theme <-  theme_bw() + theme(legend.direction="horizontal", legend.position=c(0.9,1.034), legend.title=element_blank(), text = element_text(size = 19))
flower <- ggplot(flower_dat_vis, aes(x=species, y=Global.Patch.Covariance)) +
geom_violin(trim=FALSE, fill="gray")+
labs(title="", x = "", y = "Global Heterogeneity")
flower + theme
